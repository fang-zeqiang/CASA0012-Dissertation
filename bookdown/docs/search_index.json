[["index.html", "CASA dissertation using Bookdown Abstract", " CASA dissertation using Bookdown Andrew MacLachlan CASA0010, MSc Smart Cities Dissertation Supervisor: Dr Andrew MacLachlan Repository: https://andrewmaclachlan.github.io/CASA0005repo/ This dissertation is submitted in part requirement for the MSc (Or MRes) in the Centre for Advanced Spatial Analysis, Bartlett Faculty of the Built Environment, UCL Word count: 2021-04-12 Abstract Some abstract text "],["declaration.html", "Declaration", " Declaration I hereby declare that this dissertation is all my own original work and that all sources have been acknowledged. It is xxx words in length "],["acknowledgements.html", "Acknowledgements", " Acknowledgements I would like to thank blah blah "],["abbreviations.html", "Abbreviations", " Abbreviations Term Abbreviation Digital Elevation Model DEM Digital Surface Model DSM Digital Terrain Model DTM "],["bookdown-basics.html", "Chapter 1 Bookdown basics 1.1 Structure 1.2 Building the book 1.3 YAMLs 1.4 Formatting 1.5 Index file 1.6 Preamble 1.7 Change this to a thesis 1.8 Word count 1.9 Adding a pdf 1.10 Writing code 1.11 Package reproducibility", " Chapter 1 Bookdown basics Bookdown enables us to take raw text files (e.g. Rmarkdown files) and output them into a number of different formats with ease. This is more useful than LaTex as you can create a word version for comments from your supervisor, a pdf for final submission and an online book for your own portfolio. 1.1 Structure A bookdown book simply combines multiple Rmarkdown files into .pdf, html or .epub (but ive disabled epub here). All Rmakdown files must be located in the base (or root) of the project. For example, dont got putting the .Rmd in a folder called chapters and then wonder why its not working. They all must be in the same folder as the project file. You can however put output figure images into a folder (e.g. figures) then call them in. 1.2 Building the book You will need the packages: bookdown, kabble, knitr You also need to install tinytex::install_tinytex() for generating .pdfs from your book. Once installed you can build the book by clicking the Build Book icon under the build tab in the top right quadrant. To export the book to word follow the code below from Edd Berry: bookdown::preview_chapter(&quot;01-intro.Rmd&quot;, output_format = &quot;bookdown::word_document2&quot;, output_file = paste0(&quot;thesis-intro-&quot;, format(Sys.Date(), (&quot;%d-%m-%y&quot;)), &quot;.docx&quot;), output_dir = &quot;chapter-previews&quot;) You can also setup a reference document if you wish that word will style it on. To do so: export to word using the code above. change the headings styles in word save the document add the output_options() function to the code above See Custom Word Templates for more detailed instructions. bookdown::preview_chapter(&quot;01-intro.Rmd&quot;, output_format = &quot;bookdown::word_document2&quot;, output_file = paste0(&quot;thesis-intro-&quot;, format(Sys.Date(), (&quot;%d-%m-%y&quot;)), &quot;.docx&quot;), output_dir = &quot;chapter-previews&quot;, output_options = list(reference_docx = &quot;word-style-ref.docx&quot;)) You can also export the whole document as word by clicking Build Book and selecting it. However, note that tables built with Kabble dont work with word, so you have the following options create the html (gitbook) and copy the tables into word either exclude them (eval=FALSE) in the code chunk header use .pdf. 1.3 YAMLs You will see some files with a .yml extension. These stand for yet another markup language. Open the _output.yml and _bookdown.yml. The _output.yml controls the settings for each outputted format. The _bookdown.yml controls the order in which the files are made into chapters - you can also change the Chapter title if you wish here. I have set these up to create nice outputs, so there is really no need to change anything, unless you want to add a new chapter and include it in the list. To do so, simply create a new Rmarkdown document, delete all the default content, add a first level heading, and the then add it to where you want it to appear in the document in the _bookdown.yml. 1.4 Formatting Youll notice in the _output.yml that the various formats (html (or gitbook) and pdf) are calling styling codes. The gitbook calls style.css and the pdf_book calls preamble.tex. These files just style the various outputs. I have copied in a basic styling with a CASA logo in the table of contents, you can replace this with other variations of the file if you wish or look at the minimal bookdown example or my CASA0005 .css file. The best place to learn more about styling is the RStudio for education bookdown guide For the .pdf version in the preamble.tex we have to use LaTex code. I am by no means an expert in this. If you Google each package it will tell you what it does. There isnt much here really, but all the header stuff refers to the headings at the top of each page. This tutorial from OurCoding Club explains some of the LaTex packages in a bit more detail: https://ourcodingclub.github.io/tutorials/rmarkdown-dissertation/ 1.5 Index file Open up the index.Rmd this Rmd must be called first in the _bookdown.yml list. There are a number of options here, but ive set them all up to be compliant with the CASA thesis requirements. You will need to change your title and name etc. Make sure you leave the a space here: | Andrew MacLachlan this wont work |Andrew MacLachlan If you were to be printing your work, youd want to change the classoption to twosides and make sure the geometry margins were correct. linestrech refers to the line spacing and the bibliography stuff we come on to later. Input your GitHub repo and add a description. If you ever wanted to just create a report and not a thesis you can change the documentclass to other options such report, article or letter 1.6 Preamble Open the preable.Rmd and you will see all the sections that are required before the main text (e.g. Declaration and so on). At the top of the page ive used a code chunk set to LaTex, saying to use Roman numbering as we dont want page 1 to be the Declaration, we want it to be the first page of the Introduction. There are two conditions for each of the sections that state if output to HTML (gitbook) then do this, if output to LaTex then do this. This is the only place we have this. In our bookdown HTML we want to be able to click these sections, but in our LaTex .pdf we dont want them to appear in the table of contents. This is what this code is doing. The Abstract is on the index.Rmd the same code condition applies to it, with Roman numbering also specified. If you look back in the _output.yml youll also see the toc (table of contents) is set to false. By default this appears right after the title, but we want this to come after our preable.Rmd. Youll see that ive called \\tableofcontents, \\listoffigures and \\listoftables in the correct place again using a LaTex code chunk. These arent required for the bookdown output. The last section here is the abbreviations. To make this really easy, ive created an excel document to add them into. The code here will load that and then use the kable package to make a table. More on this later.Ive also done the same for the research log in the appendix  excel sheet called research_log. 1.7 Change this to a thesis Easy. Just change all the titles to what you want (e.g. Introduction, Literature Review, Methodology, Discussion, Conclusion). Some of the latter .Rmds (Discussion etc) are ready to go! 1.8 Word count To get a word count install and then use the word count addin package through Tools&gt;Addins&gt;Wordcount 1.9 Adding a pdf If you wish to add another .pdf as an Appendix (in your .pdf) then again we need a bit of LaTex code \\includepdf[pages={-}]{mypdf.pdf} If you look in the 08-Appendix.Rmd then you will see another if LaTex section, simply add in the line of code above, replacing mypdf.pdf with your pdf title in the main project folder. It will then be appended to the thesis. Of course, this isnt required in the online book, but you just link to them on GitHub or embed .pdfs using: Youd need a condition around this like in the preamble.Rmd but a link is fine. I embedded a .pdf in the assignment resources of CASA0005 1.10 Writing code Use one project for your thesis and another for your analysis. Dont try and do it all in a thesis project. You can set your output folder from your main analysis project to the thesis project and then easily load the figures in. 1.11 Package reproducibility Have you ever created an R script, come back to it 6 months later and wonder why its not working correctly? Its probably because of package updates. renv (pronounced R - env) can capture the packages used in your project and re-create your current library. You simply: Create a new project - renv::init() Create a snapshot - renv::snapshot() Call the snapshot to load - renv::restore() The package information and dependencies are stored in a renv.lock file. When R loads a package it gets it from the library path, which is where the packages live. Sometimes there are two libraries a system and a user library - use .libPaths(). The system library = the packages with R, the user library = packages you have installed. When you load a package it loads the first instance it comes across, user comes before system. To check - find.package(\"tidyverse\") All your projects use these paths! If you load different packages and versions of them + dependencies. E.g. Project 1 used sf version 0.9-8 Project 2 used sf version 0.9-6 Switching between projects would mean you have the wrong version as they use the same libraries. renv - each project gets its own library! Project local libraries. When you use renv::init() the library path will be changed to a project local one. It will create a lock file that holds all the package information. To re-create my environment once you have forked and pulled this repository you would use renv::restore(). Of coruse some projects use the same package version  such as tidyverse, renv has a global cache of all the libraries. So there is a massive database of your libraries then each project library links it from there, meaning you dont have 10 versions of the same tidyverse. You can also interact with git renv::history()  finds the commits where the lock file changed renv::revert(commit = \"id\")  changes the lock file back to what it was at a commit For more information watch renv: Project Environments for R introduction video: https://www.rstudio.com/resources/rstudioconf-2020/renv-project-environments-for-r/ "],["crossref.html", "Chapter 2 Cross referencing 2.1 Chapters or sections 2.2 Figures, tables, even code chunks 2.3 Citing documents 2.4 Citing using software 2.5 Footnotes", " Chapter 2 Cross referencing 2.1 Chapters or sections Always give you sections an additional referencee.g. # Cross referencing {#crossref} This gives us two reference points. The first we can use to reference the section name We want to say see the Introduction (or other section label)we use [Cross referencing] giving Cross referencing But what if we want to reference the section number (e.g. Chapter 1 or section 4.2) Just reference the label we gave to the section.see Chapter \\@ref(crossref) giving see Chapter 2 2.2 Figures, tables, even code chunks 2.2.1 Figures When you create a figure, table or code chunk there is an option to name the chunk something. Do it!. Dont be like me and not! Be warned that these chunk names cant have any fancy or strange characters in them e.g. _. I think a - is allowed, but id keep it simple. Here is a figure. In the chunk options after r i have specified nice-fig, echo=FALSE, fig.cap='Here is a nice figure!', out.width='80%' Figure 2.1: Here is a nice figure! To cross reference this just include Figure \\@ref(fig:nice-fig) which givesFigure 2.1. 2.2.2 Tables For tables id recommend using the kable package. Here is an example table, same deal as the Figures section with naming the code chunk. knitr::kable( head(iris, 20), caption = &#39;Here is a nice table!&#39;, booktabs = TRUE ) Table 2.1: Here is a nice table! Sepal.Length Sepal.Width Petal.Length Petal.Width Species 5.1 3.5 1.4 0.2 setosa 4.9 3.0 1.4 0.2 setosa 4.7 3.2 1.3 0.2 setosa 4.6 3.1 1.5 0.2 setosa 5.0 3.6 1.4 0.2 setosa 5.4 3.9 1.7 0.4 setosa 4.6 3.4 1.4 0.3 setosa 5.0 3.4 1.5 0.2 setosa 4.4 2.9 1.4 0.2 setosa 4.9 3.1 1.5 0.1 setosa 5.4 3.7 1.5 0.2 setosa 4.8 3.4 1.6 0.2 setosa 4.8 3.0 1.4 0.1 setosa 4.3 3.0 1.1 0.1 setosa 5.8 4.0 1.2 0.2 setosa 5.7 4.4 1.5 0.4 setosa 5.4 3.9 1.3 0.4 setosa 5.1 3.5 1.4 0.3 setosa 5.7 3.8 1.7 0.3 setosa 5.1 3.8 1.5 0.3 setosa Now to cite the table its just Table \\@ref(tab:nice-tab), giving Table 2.1 2.3 Citing documents To cite documents they need to be in a .bib file, that must be loaded within your index.Rmd with the bibliography: argument. Have a look at my index.Rmd and you will see there are three such files, two that were provided as an example here book.bib, packages.bib and one that i added test.bib. I can simply cite the papers within them using the citation key e.g. [@xie2015] giving (Xie 2015). Make sure you remove the ones you dont need. If you remove the citation from the [] it will give Xie (2015). When citing multiple authors use a ; [@xie2015; @maclachlan2017urban] = (Xie 2015; MacLachlan et al. 2017) To remove the author add a minus sign -@maclachlan2017urban = (2017) 2.4 Citing using software Zotero can now continuously update your .bib file. To do so: Download the latest release  the .xpi file: https://github.com/retorquere/zotero-better-bibtex/releases/tag/v5.2.108 In Zotero &gt; Tools &gt; Add ons &gt; Extensions Select the cog &gt; Install add on from file Select the .xip &gt; restart Zotero. On the restart select the default naming convention. To export the library File &gt; export Select Better BibLaTex Click keep updated Select the file to save into your Thesis project Make sure you have the file listed in your bibliography in the index.Rmd file You can also manage references using citr which makes finding them to cite much easier. In RStudio go: Addins (top tool bar) &gt; insert citations. 2.5 Footnotes To add a footnote use ^[This is a footnote] to create.1 References "],["equations-and-direct-quotes.html", "Chapter 3 Equations and direct quotes 3.1 Equations 3.2 Block quotes (or direct quotes)", " Chapter 3 Equations and direct quotes This section will focus on equations and direct quotes 3.1 Equations You need to include equations with some LaTeX. The easiest way to do this is to use an online tool such as: https://latex.codecogs.com/eqneditor/editor.php. It can be a real pain to get these right, but once youve worked it out it will be much easier than dealing with word equation editor. \\[\\begin{equation} p= h\\frac{c}{\\varrho} \\tag{3.1} \\end{equation}\\] To reference this in the text we use: (3.1) You can also test your code in your RMarkdown document using $ e.g. \\[p= h\\frac{c}{\\varrho}\\] However, this wont generate an equation number and you cant cross reference it. But we can use this logic to define the parameters within the equation e.g. where \\(h\\) is Planks constant, \\(6.626 × 10^-34 Js\\) $$ puts it on a new line, single $ keeps it on the same line (in the text) 3.2 Block quotes (or direct quotes) You may wish to quote a large section from a source, to do this use a block quote. Simply input a &gt; before the text. For example &gt; This is a quote. This is a direct quote You can also provide an attribution at the footer of the quote using tufte::quote_footer(), either a name or a reference. Youll need to install the tufte package to use this. For example, &gt; [include only r here] tufte::quote_footer('--- Joe Martin') or &gt; [include only r here] tufte::quote_footer('--- @xie2015') Giving  Joe Martin  Xie (2015) Instead you could just include the reference at the end of the quote, using the same method to reference as weve seen before..e.g. &gt; \"This is a direct quote\" @xie2015, Equation \\@ref(eq:test)giving This is a direct quote Xie (2015) (3.1) References "],["figures-tables-hosting-gitbook.html", "Chapter 4 Figures, tables, hosting GitBook 4.1 Including figures and tables 4.2 Hosting the book", " Chapter 4 Figures, tables, hosting GitBook This section is going to focus including figures and creating tables Figure 4.1: Summary of methdological procedure for (a). and (b). 4.1 Including figures and tables 4.1.1 Figures To include the figure above use the code: knitr::include_graphics(here::here('general_images','example_flow.png')) within a code chunk. In the chunk options you can specify the width and figure captions e.g. out.width=\"100pt\", fig.cap=\"Summary of methdological procedure for (a).... and (b)....\". However, if you do show the code with echo=TRUE then you cant specify the out.width. For making flow diagrams have a look at: Lucidchart Draw.io 4.1.2 Tables For creating tables id suggest creating either an excel file or .csv and then reading the data into R and using the kabble package to format it how you wish. The example below is from the abbreviations section library(tidyverse) library(knitr) library(kableExtra) library(readxl) library(fs) library(here) #read in data read_excel(here(&quot;tables&quot;, &quot;abbreviations.xlsx&quot;))%&gt;% arrange(Term) %&gt;% # i.e. alphabetical order by Term # booktab = T gives us a pretty APA-ish table knitr::kable(booktabs = TRUE)%&gt;% kable_styling(position = &quot;center&quot;)%&gt;% # any specifc row changes you want row_spec(., row=0, bold = TRUE) Term Abbreviation Digital Elevation Model DEM Digital Surface Model DSM Digital Terrain Model DTM You do loads of things with kabble including adding small visulisations within the table - consult the documentation for more info. If in doubt, keep it simple other useful arguments for tables: column_spec(2, width = \"9cm\") = set column width kable(timeline,longtable = T....= allow the table to go over multiple pages For example read_excel(here(&quot;tables&quot;, &quot;policy.xlsx&quot;))%&gt;% mutate_all(~ replace_na(.x, &quot;&quot;)) %&gt;% # booktab = T gives us a pretty APA-ish table knitr::kable(longtable = T, booktabs = T, caption = &#39;Relevant influential international, metropolitan and local UHI and urban expansion policies, strategies and assessments (with publication date) referred to in this paper. * Denotes documents that lack specific UHI related policy but recognise the value of maintaining vegetation.&#39;)%&gt;% kable_styling(position = &quot;center&quot;, full_width = T)%&gt;% # any specifc row changes you want row_spec(., row=c(0,1,8, 18), bold = TRUE)%&gt;% column_spec(1, width = &quot;14cm&quot;)%&gt;% row_spec(c(1, 8, 18), hline_after = T) Table 4.1: Relevant influential international, metropolitan and local UHI and urban expansion policies, strategies and assessments (with publication date) referred to in this paper. * Denotes documents that lack specific UHI related policy but recognise the value of maintaining vegetation. Policy International United Nations The World Cities in 2016 (2016) United Nations New Urban Agenda (2017) ARUP City Resilience Framework (2015) United Nations International Strategy for Disaster Reduction Sendai Framework (2015) Universal Sustainable Development Goals (2015) Biological Diversity, Cities and Biodiversity Outlook (2012) Metropolitan AECOM Australia, Economic Assessment of the Urban Heat Island Effect, Melbourne (2012) The Spatial Development Strategy For Greater London (2017) Western Australia Planning Commission, Perth and Peel (3.5?) million (2015) City of Johannesburg Metropolitan Municipality, Spatial Development Framework 2040 (2016) Western Australian Planning Commission, Directions 2031 and beyond: metropolitan planning beyond the horizon (2010) Western Australian Planning Commission, Development Control Policy 2.3 Public Open Space in Residential Areas (2002) Plan For The Metropolitan Region Perth And Fremantle (1955) Singapore Government, Open Space Provision (2011) Western Australian Planning Commission, Metropolitan Region Scheme Text (2006) Local USA Environmental Protection Agency, Reducing Urban Heat Islands Compendium of Strategies Trees and Vegetation (2008) USA Environmental Protection Agency, Reducing Urban Heat Islands Compendium of Strategies Urban Heat Island Basics (2008) USA Environmental Protection Agency, Reducing Urban Heat Islands, Compendium of Strategies Heat Island Reduction Activities (2008) City of Stirling, Stirling Urban Forest Community Consultation (2017) City of Fremantle, One Planet Fremantle Strategy 2014/2015 - 2019/2020, 112 (2014) Metropolitan Redevelopment Authority, Subiaco Redevelopment Scheme (2013) Metropolitan Redevelopment Authority, Subiaco Redevelopment Scheme 2 (2017) City of Bayswater, Urban Forest Strategy (2017) City of Perth, Urban Forest Plan 2016-2036 (2006) City of Fremantle, City of Fremantle Urban Forest Plan (2017) City of Fremantle, Annual Budget 2016-17 (2016) City of Wanneroo, Street Tree Policy (2016)* City of Subiaco, Plant Pathogen Management Plan(2015)* Note if you see the caption in the .pdf version it goes off the side of the page  this is the reason why you dont show code in a .pdf. If you ever had to you could just seperate the string into sections and at the start use paste(\"hello\",\"this\",\"is\",\"a\",\"string\", sep=\" \") Now remember to cross reference this table, it would beTable \\@ref(tab:kable), giving Table 4.1 4.2 Hosting the book You will need to create a new GitHub repository to host your book online using GitHub pages  like the example is. GitHub pages takes a load of .html files and makes a website. To do so you need to set up a few things Go to the _bookdown.yml file and make sue that that you have this line of code: output_dir: docs (it should be there) In the same file make sure your book_filename doesnt have any spaces use - or _ e.g. CASA-Thesis Go to the _output.yml file and change the edit argument to YOURREPO/edit/main/%s, here its https://github.com/andrewmaclachlan/CASA-MSc-thesis/edit/main/%s Build your book locally, close the preview window Save, stage changes, commit and then push to GitHub On your GitHub repository &gt; settings &gt; GitHub pages &gt; select the source as main and the folder as docs Make sure you build your .pdf and then your gitbook for the latest .pdf to be a download option on the website. "],["discussion.html", "Chapter 5 Discussion 5.1 Research significance 5.2 Limitations 5.3 Transferability", " Chapter 5 Discussion Short introduction to the chapter, reviewing the previous chapter and detailing what this one aims to achieve and build upon. 5.1 Research significance 5.1.1 Global development goals 5.1.2 Local policy 5.1.3 Academic research 5.2 Limitations 5.3 Transferability "],["conclusion.html", "Chapter 6 Conclusion 6.1 Recommedations", " Chapter 6 Conclusion Short introduction to the chapter, reviewing the previous chapter and detailing what this one aims to achieve and build upon. 6.1 Recommedations Adapt policy x Undertake data informed targeted greening Further work into this area "],["references.html", "References", " References "],["appendix-a-research-log.html", "Appendix A Research log subsection", " Appendix A Research log subsection sub sub section Date Task 31st May 2020 data search, commenced literature review 7th June 2020 revised literature in the direction of x "]]
